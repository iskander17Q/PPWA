{% extends "users/base.html" %}
{% block users_content %}
<div class="page-header">
    <h1>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
    <p class="muted">ID: #{{ form_data.id }}</p>
</div>

{% if errors and errors|length %}
<div class="alert error">
    <span>‚ö†Ô∏è</span>
    <div>
        {% for err in errors %}<div>{{ err }}</div>{% endfor %}
    </div>
</div>
{% endif %}

<div class="card">
    <form method="post">
        <div class="field">
            <label for="email">Email *</label>
            <input type="email" id="email" name="email" value="{{ form_data.email }}" required>
        </div>
        <div class="field">
            <label for="name">–ò–º—è</label>
            <input type="text" id="name" name="name" value="{{ form_data.name or '' }}">
        </div>
        <div class="field">
            <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
            <input type="tel" id="phone" name="phone" value="{{ form_data.phone or '' }}">
        </div>
        <div class="field">
            <label for="role">–†–æ–ª—å *</label>
            <select id="role" name="role" required>
                <option value="USER" {% if form_data.role=='USER' %}selected{% endif %}>USER</option>
                <option value="ADMIN" {% if form_data.role=='ADMIN' %}selected{% endif %}>ADMIN</option>
            </select>
        </div>
        <div class="field">
            <label for="plan_id">–¢–∞—Ä–∏—Ñ *</label>
            <select id="plan_id" name="plan_id" required>
                {% for plan in plans %}
                <option value="{{ plan.id }}" {% if form_data.plan_id==plan.id %}selected{% endif %}>{{ plan.name }}
                </option>
                {% endfor %}
            </select>
        </div>
        <div class="field" style="display: flex; align-items: center; gap: 8px; padding: 12px; background: var(--bg-secondary); border-radius: 8px;">
            <input type="checkbox" id="is_active" name="is_active" value="true" {% if form_data.is_active %}checked{% endif %}>
            <label for="is_active" style="margin:0; cursor: pointer;">–ê–∫—Ç–∏–≤–µ–Ω</label>
        </div>

        <div class="field" style="margin-top: 24px; padding-top: 24px; border-top: 2px solid var(--border-color);">
            <label style="color: var(--text-secondary); font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è</label>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-top: 12px;">
                <div style="padding: 12px; background: var(--bg-secondary); border-radius: 8px;">
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">ID</div>
                    <div style="font-weight: 600; font-size: 16px;">{{ form_data.id }}</div>
                </div>
                <div style="padding: 12px; background: var(--bg-secondary); border-radius: 8px;">
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">–°–æ–∑–¥–∞–Ω</div>
                    <div style="font-weight: 600; font-size: 14px;">{{ form_data.created_at.strftime("%Y-%m-%d %H:%M") if form_data.created_at else "‚Äî" }}</div>
                </div>
                <div style="padding: 12px; background: var(--bg-secondary); border-radius: 8px;">
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">–ü–æ–ø—ã—Ç–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</div>
                    <div style="font-weight: 600; font-size: 16px; color: var(--primary);">{{ form_data.free_attempts_used }}</div>
                </div>
            </div>
        </div>
        
        <div style="display: flex; gap: 12px; margin-top: 24px;">
            <button type="submit" class="btn primary" style="flex: 1;">
                <span>üíæ</span>
                <span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</span>
            </button>
            <a class="btn" href="/users/{{ form_data.id }}" style="background: var(--text-secondary);">
                <span>–û—Ç–º–µ–Ω–∞</span>
            </a>
        </div>
    </form>
</div>
{% endblock %}