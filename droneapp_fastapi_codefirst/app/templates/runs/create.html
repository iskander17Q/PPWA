{% extends "users/base.html" %}
{% block content %}
<div class="card">
    <h2 style="margin-top:0;">Создать Processing Run</h2>

    {% if errors and errors|length %}
        <div class="errors">
            {% for err in errors %}<div>{{ err }}</div>{% endfor %}
        </div>
    {% endif %}

    <form method="post">
        <fieldset>
            <div class="field">
                <label for="user_id">Пользователь *</label>
                <select id="user_id" name="user_id" required>
                    {% for u in users %}
                        {% set selected = form_data.user_id if form_data else None %}
                        <option value="{{ u.id }}" {% if selected == u.id %}selected{% endif %}>{{ u.email }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="field">
                <label for="index_type">Index Type *</label>
                {% set current_index = form_data.index_type if form_data else 'NDVI' %}
                <select id="index_type" name="index_type" required>
                    <option value="NDVI" {% if current_index == 'NDVI' %}selected{% endif %}>NDVI</option>
                    <option value="GNDVI" {% if current_index == 'GNDVI' %}selected{% endif %}>GNDVI</option>
                </select>
            </div>
            <div class="field">
                <label for="status">Status</label>
                {% set current_status = form_data.status if form_data else 'QUEUED' %}
                <select id="status" name="status">
                    <option value="QUEUED" {% if current_status == 'QUEUED' %}selected{% endif %}>QUEUED</option>
                    <option value="SUCCESS" {% if current_status == 'SUCCESS' %}selected{% endif %}>SUCCESS</option>
                    <option value="FAILED" {% if current_status == 'FAILED' %}selected{% endif %}>FAILED</option>
                </select>
            </div>
            <div class="field">
                <label>Чтение</label>
                <div class="meta">
                    <div class="item"><strong>ID</strong><br>—</div>
                    <div class="item"><strong>Создан</strong><br>—</div>
                </div>
            </div>
            <button type="submit" class="btn">Сохранить</button>
        </fieldset>
    </form>
</div>
{% endblock %}
